<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Attendance Alerts</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 16px; }
    .badge { padding: 4px 8px; border-radius: 4px; color: #fff; }
    .Late { background: #f39c12; }
    .Absent { background: #e74c3c; }
    .event { padding: 8px; border-bottom: 1px solid #eee; }
  </style>
</head>
<body>
  <h2>Live Attendance Alerts</h2>
  <div id="list"></div>
<script>
  const list = document.getElementById('list');
  const es = new EventSource('/api/attendance/stream');
  es.addEventListener('attendance-alert', (e) => {
    try {
      const d = JSON.parse(e.data);
      const div = document.createElement('div');
      div.className = 'event';
      div.innerHTML = `<span class="badge ${d.type}">${d.type}</span> ` +
        `${d.student.studentName} (${d.student.studentId}) - ${d.className} ` +
        (d.type === 'Late' ? ` - Late by ${d.lateMinutes} min` : '') +
        ` <small>${new Date(d.date).toLocaleString()}</small>`;
      list.prepend(div);
    } catch {}
  });
</script>
</body>
</html>
